generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}


model LessonCategory {
  id        Int       @id @default(autoincrement())
  name      String    @db.VarChar(255)
  questions Question[]

  @@map("lesson_categories")
}

model Question {
  id                  Int               @id @default(autoincrement())
  jsonId              String            @db.VarChar(255)
  title               String            @db.Text
  img                 String?           @db.VarChar(255)
  correctAnswerIndex  Int
  lessonCategoryId    Int
  lessonCategory      LessonCategory    @relation(fields: [lessonCategoryId], references: [id], onDelete: Cascade)
  options             QuestionOption[]
  comments            QuestionComment[]

  @@unique([lessonCategoryId, jsonId])
  @@map("questions")
}

model QuestionOption {
  id          Int      @id @default(autoincrement())
  text        String   @db.Text
  order       Int
  questionId  Int
  question    Question @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([questionId, order])
  @@map("question_options")
}

model QuestionComment {
  id         Int      @id @default(autoincrement())
  questionId Int
  question   Question @relation(fields: [questionId], references: [id], onDelete: Cascade)
  authorName String   @db.VarChar(255)
  text       String   @db.Text
  isReported Boolean  @default(false)
  isApproved Boolean  @default(true)
  createdAt  DateTime @default(now())
  reports    CommentReport[]

  @@index([isReported, isApproved])
  @@map("question_comments")
}

model CommentReport {
  id        Int      @id @default(autoincrement())
  commentId Int
  comment   QuestionComment @relation(fields: [commentId], references: [id], onDelete: Cascade)
  reason    String?  @db.VarChar(255)
  createdAt DateTime @default(now())

  @@index([commentId])
  @@map("comment_reports")
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique @db.VarChar(255)
  name          String?  @db.VarChar(255)
  password      String   @db.VarChar(255)
  role          String   @default("user") @db.VarChar(50)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("users")
}

model Registration {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(255)
  phone       String   @db.VarChar(255)
  hasDiscount Boolean  @default(false)
  createdAt   DateTime @default(now())

  @@map("registrations")
}

model Contact {
  id        Int      @id @default(autoincrement())
  firstName String   @db.VarChar(255)
  lastName  String   @db.VarChar(255)
  phone     String   @db.VarChar(255)
  message   String   @db.Text
  createdAt DateTime @default(now())

  @@map("contacts")
}

model Setting {
  id        Int      @id @default(autoincrement())
  key       String   @unique @db.VarChar(255)
  value     String   @db.Text
  updatedAt DateTime @updatedAt

  @@map("settings")
}

model BlogPost {
  id          Int      @id @default(autoincrement())
  title       String   @db.VarChar(500)
  slug        String   @unique @db.VarChar(500)
  excerpt     String   @db.Text
  content     String   @db.Text
  featuredImage String? @db.VarChar(500)
  metaTitle   String?  @db.VarChar(500)
  metaDescription String? @db.Text
  keywords    String?  @db.Text
  isPublished Boolean  @default(false)
  publishedAt DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([slug])
  @@index([isPublished, publishedAt])
  @@map("blog_posts")
}

model RulesSection {
  id          Int       @id @default(autoincrement())
  title       String    @db.VarChar(500)
  slug        String    @unique @db.VarChar(500)
  description String    @db.Text
  content     String    @db.Text
  order       Int       @default(0)
  icon        String?   @db.VarChar(100)
  color       String?   @db.VarChar(50)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  items       RuleItem[]

  @@index([slug])
  @@index([order])
  @@map("rules_sections")
}

model RuleItem {
  id          Int          @id @default(autoincrement())
  number      String       @db.VarChar(50)
  title       String?      @db.VarChar(500)
  content     String       @db.Text
  type        String       @default("rule") @db.VarChar(50)
  important   Boolean      @default(false)
  order       Int          @default(0)
  sectionId   Int
  section     RulesSection @relation(fields: [sectionId], references: [id], onDelete: Cascade)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  @@index([sectionId])
  @@index([sectionId, order])
  @@map("rule_items")
}

model PsychologicalQuestion {
  id                  Int                        @id @default(autoincrement())
  jsonId              String                     @db.VarChar(255)
  title               String                     @db.Text
  img                 String?                    @db.VarChar(255)
  correctAnswerIndex  Int
  isRealPsychological Boolean                    @default(false)
  options             PsychologicalQuestionOption[]

  @@unique([jsonId])
  @@map("psychological_questions")
}

model PsychologicalQuestionOption {
  id          Int                  @id @default(autoincrement())
  text        String               @db.Text
  order       Int
  questionId  Int
  question    PsychologicalQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@unique([questionId, order])
  @@map("psychological_question_options")
}

model RoadSign {
  id          Int      @id @default(autoincrement())
  number      String   @db.VarChar(50)
  name        String   @db.VarChar(500)
  description String   @db.Text
  category    String   @db.VarChar(50)
  image       String?  @db.VarChar(500)
  placement   String?  @db.Text
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([number])
  @@map("road_signs")
}

model RoadMarking {
  id          Int      @id @default(autoincrement())
  number      String   @db.VarChar(50)
  name        String   @db.VarChar(500)
  description String   @db.Text
  category    String   @db.VarChar(50)
  image       String?  @db.VarChar(500)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([number])
  @@map("road_markings")
}

model VehicleIdentificationSign {
  id          Int      @id @default(autoincrement())
  number      String   @db.VarChar(50)
  name        String   @db.VarChar(500)
  description String   @db.Text
  image       String?  @db.VarChar(500)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([number])
  @@map("vehicle_identification_signs")
}

model VehicleTechnicalDefect {
  id          Int      @id @default(autoincrement())
  number      String   @db.VarChar(50)
  description String   @db.Text
  category    String   @db.VarChar(50)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@index([number])
  @@map("vehicle_technical_defects")
}

model TrafficLawItem {
  id          Int      @id @default(autoincrement())
  name        String   @db.VarChar(500)
  description String   @db.Text
  category    String   @db.VarChar(100)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([category])
  @@map("traffic_law_items")
}
